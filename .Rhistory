resid = logy - y_hat
plot(resid)
plot(yhat,logy)
plot(y_hat,logy)
plot(exp(y_hat),y)
y_hat = exp(y_hat)
resid = y - y_hat
plot(resid)
mean(resid)
sd(resid)
y_hat[i] = pm_params[1] + pm_params[2:9]%*%X[i,1:8] + pm_params[9+X[i,9]]*X[i,8]
for (i in 1:length(y)){
y_hat[i] = pm_params[1] + pm_params[2:9]%*%X[i,1:8] + pm_params[9+X[i,9]]*X[i,8]
}
#y_hat = exp(y_hat)
resid = logy - y_hat
plot(resid)
mean(resid)
sd(resid)
plot(exp(y_hat),y)
plot(y_hat,logy)
R2 = cor(y_hat,logy)^2
mean(resid)
sd(resid)
plot(y_hat,logy)
points(logy,logy,col="red")
points(logy,logy,col="red",lty=2)
line(logy,logy,col="red")
add(logy,logy,col="red")
lines(logy,logy,col="red")
plot(y_hat,logy)
lines(logy,logy,col="red")
plot(resid)
# check our model using residuals
pm_params = colMeans(mod_csim)
pm_params
plt(dlaplace(m=pm_params[83],s=pm_params[10]))
plot(dlaplace(m=pm_params[83],s=pm_params[10]))
library(rmutil)
library(rmutil)
plot(dlaplace(m=pm_params[83],s=pm_params[10]))
plot(density(y = pm_params[10:82]))
plot(density(pm_params[10:82]))
pm_params
mean(sample_sizes)
# plot data
plot(density(y))
plot(density(log(y)))
plot(jiiter(resid))
plot(jiter(resid))
plot(jitter(resid))
plot(resid)
boxplot(logy~X[,"District"])
Cor(logy,X[,"Condo"])
Corr(logy,X[,"Condo"])
cor(logy,X[,"Condo"])
cor(logy,X[,"Size"])
cor(logy,X[,"Rooms"])
plot(X[,"Size"])
plot(density(X[,"Size"]))
plot(density(X[,"Rooms"]))
plot(density(X[,"Suites"]))
#get the  two districts with the highest NEW slopes
district1 = 1
current_max = 0
#get the  two districts with the highest NEW slopes
district1 = 1
current_max = 0
for (i in 1:length(pm_params[10:82])){
if(pm_params[9+i] > current_max){
current_max = pm_params[9+i]
district1 = i
}
}
district1
#get the  two districts with the highest NEW slopes
district1 = 1
current_max = 0
for (i in 1:length(pm_params[10:82])){
pm_params[9+i]
if(pm_params[9+i] > current_max){
current_max = pm_params[9+i]
district1 = i
}
}
vec_bnew = pm_params[10:82]
vec_bnew
for (i in 1:length(vec_bnew)){
pm_params[9+i]
if(pm_params[9+i] > current_max){
current_max = pm_params[9+i]
district1 = i
}
}
for (i in 1:length(vec_bnew)){
pm_params[9+i]
#if(pm_params[9+i] > current_max){
#  current_max = pm_params[9+i]
#  district1 = i
#}
}
for (i in 1:length(vec_bnew)){
print(pm_params[9+i])
#if(pm_params[9+i] > current_max){
#  current_max = pm_params[9+i]
#  district1 = i
#}
}
for (i in 1:length(vec_bnew)){
a = pm_params[9+i]
print(length(a))
#if(pm_params[9+i] > current_max){
#  current_max = pm_params[9+i]
#  district1 = i
#}
}
for (i in 1:length(vec_bnew)){
a = pm_params[9+i]
print(a)
#if(pm_params[9+i] > current_max){
#  current_max = pm_params[9+i]
#  district1 = i
#}
}
for (i in 1:length(vec_bnew)){
a = pm_params[9+i]
print(a[1])
#if(pm_params[9+i] > current_max){
#  current_max = pm_params[9+i]
#  district1 = i
#}
}
print(a[1,1])
vec_bnew
for (i in 1:length(vec_bnew)){
a = pm_params[9+i]
print(a[1,1])
#if(pm_params[9+i] > current_max){
#  current_max = pm_params[9+i]
#  district1 = i
#}
}
for (i in 1:length(vec_bnew)){
a = pm_params[9+i]
print(a[0])
#if(pm_params[9+i] > current_max){
#  current_max = pm_params[9+i]
#  district1 = i
#}
}
for (i in 1:length(vec_bnew)){
a = pm_params[9+i]
print(obj(a))
#if(pm_params[9+i] > current_max){
#  current_max = pm_params[9+i]
#  district1 = i
#}
}
for (i in 1:length(vec_bnew)){
a = pm_params[9+i]
print(a[1])
#if(pm_params[9+i] > current_max){
#  current_max = pm_params[9+i]
#  district1 = i
#}
}
order(pm_params[10:82], decreasing = TRUE)
#get the  two districts with the highest NEW slopes
pm_params[10:82]
#get the  two districts with the highest NEW slopes
pm_params[11:82]
order(pm_params[10:82], decreasing = TRUE)
#get the  two districts with the highest NEW slopes
pm_params[11:82]
order(pm_params[11:82], decreasing = TRUE)
# residual analysis
y_hat = numeric(length = length(y))
for (i in 1:length(y)){
y_hat[i] = pm_params[1] + pm_params[2:9]%*%X[i,1:8] + pm_params[10+X[i,9]]*X[i,8]
}
#y_hat = exp(y_hat)
resid = logy - y_hat
plot(resid)
plot(y_hat,logy)
lines(logy,logy,col="red")
R2 = cor(y_hat,logy)^2
#get the  two districts with the highest NEW slopes
pm_params[11:82]
order(pm_params[11:82], decreasing = TRUE)
#Posterior predictive simulation
(n_sim = nrow(mod_csim))
#Posterior predictive simulation
(n_sim = nrow(mod_csim))
View(mod_sim)
View(mod_sim)
#Posterior predictive simulation
mod_csim
View(X)
View(X)
# check our model using residuals
pm_params = colMeans(mod_csim)
pm_params
# residual analysis
y_hat = numeric(length = length(y))
for (i in 1:length(y)){
y_hat[i] = pm_params[1] + pm_params[2:9]%*%X[i,1:8] + pm_params[10+X[i,10]]*X[i,9]
}
#y_hat = exp(y_hat)
resid = logy - y_hat
plot(resid)
plot(y_hat,logy)
lines(logy,logy,col="red")
R2 = cor(y_hat,logy)^2
params = c("sigy", "b", "bnew","mu", "b_bnew")
pm_params
X_predA = c(750,120,1,2,1,2,0,0,0)
X_predA[1:8]
X_predA = c(750,120,1,2,1,2,0,0,0)
X_predB = c(750,120,1,2,1,2,0,0,0)
X_predA = c(750,120,1,2,1,2,0,0,0)
X_predB = c(750,120,1,2,1,2,0,0,0)
y_predA[i] = mod_csim[,"b[1]"] + mod_csim[,"b[2]":"b[9]"]%*%X_predA[1:8] + mod_csim[,"bnew[45]"]*X[9]
mod_csim[,"b[2]":"b[9]"]
mod_csim[,2:9]
y_predA[i] = mod_csim[,"b[1]"] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[45]"]*X[9]
y_predA = mod_csim[,"b[1]"] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[45]"]*X[9]
y_pred1 = rlnormal(n=n_sim, meanlog=y_predA, sdlog = mod_csim[,"sigy"])
y_pred1 = rlnorm(n=n_sim, meanlog=y_predA, sdlog = mod_csim[,"sigy"])
hist(y_pred1)
density(y_pred1)
density(y_pred1)
y_pred1 = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
plot(density(y_pred1))
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[45]"]*X[9]
y_pred1 = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
X_predA = c(750,90,1,2,1,2,0,0,0)
X_predB = c(750,90,1,2,1,2,0,0,0)
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[45]"]*X[9]
y_pred1 = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
plot(density(y_pred1))
y_meanA
mod_csim[,"bnew[45]"]
X_predA = c(70,90,1,2,1,2,0,0,0)
X_predB = c(70,90,1,2,1,2,0,0,0)
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[45]"]*X[9]
y_pred1 = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
plot(density(y_pred1))
X_predA = c(700,90,1,2,1,2,0,0,0)
X_predB = c(70,90,1,2,1,2,0,0,0)
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[45]"]*X[9]
y_pred1 = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
y_pred1 = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
plot(density(y_pred1))
X_predB = c(70,90,1,2,1,2,0,0,0)
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[45]"]*X[9]
y_pred1 = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
mod_csim[,2:9]%*%X_predA[1:8]
mod_csim[,2:9]%*%X_predA[1:8]
mod_csim[,1]
mod_csim[,"bnew[45]"]*X_predA[9]
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[45]"]*X_predA[9]
y_pred1 = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
plot(density(y_pred1))
#Posterior predictive simulation
(n_sim = nrow(mod_csim))
X_predA = c(750,120,1,2,1,2,0,0,0)
X_predB = c(750,120,1,2,1,2,0,0,1)
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[45]"]*X_predA[9]
y_predA = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
y_meanB = mod_csim[,1] + mod_csim[,2:9]%*%X_predB[1:8] + mod_csim[,"bnew[45]"]*X_predB[9]
y_predB = rlnorm(n=n_sim, meanlog=y_meanB, sdlog = mod_csim[,"sigy"])
plot(density(y_predA))
curve(y_predB, col = "blue", add = TRUE)
curve(rlnorm(n=n_sim, meanlog=y_meanB, sdlog = mod_csim[,"sigy"]), col = "blue", add = TRUE)
plot(density(y_predA))
curves(y_predB, col = "blue", add = TRUE)
#Posterior predictive simulation
(n_sim = nrow(mod_csim))
X_predA = c(750,120,1,2,1,2,0,0,0)
X_predB = c(750,120,1,2,1,2,0,0,1)
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[45]"]*X_predA[9]
y_predA = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
y_meanB = mod_csim[,1] + mod_csim[,2:9]%*%X_predB[1:8] + mod_csim[,"bnew[45]"]*X_predB[9]
y_predB = rlnorm(n=n_sim, meanlog=y_meanB, sdlog = mod_csim[,"sigy"])
plot(density(y_predA))
curves(density(y_predB), col = "blue", add = TRUE)
curve(density(y_predB), col = "blue", add = TRUE)
plot(density(y_predA))
plot(density(y_predB), col = "blue", add = TRUE)
add(density(y_predB), col = "blue", add = TRUE)
plot(density(y_predA))
add(density(y_predB), col = "blue", add = TRUE)
plot(density(y_predA), xlim=c(0,500000))
plot(density(y_predA), xlim=c(0,5000000))
plot(density(y_predA), xlim=c(0,5000000))
plot(density(y_predB), col = "blue", xlim=c(0,5000000), add = TRUE)
plot(density(y_predA), xlim=c(0,5000000))
plot(density(y_predB), col = "blue", xlim=c(0,5000000), add = TRUE)
plot(density(y_predB), col = "blue", xlim=c(0,5000000), add = TRUE)
plot(density(y_predA), xlim=c(0,5000000))
plot(density(y_predB), col = "blue", xlim=c(0,5000000), add = TRUE)
plot(density(y_predB), col = "blue", xlim=c(0,5000000), add = TRUE)
plot(density(y_predA), xlim=c(0,5000000))
plot(density(y_predB), col = "blue", xlim=c(0,5000000), add = TRUE)
plot(density(y_predA), xlim=c(0,5000000))
plot(density(y_predB), col = "blue", xlim=c(0,5000000), add = TRUE)
plot(density(y_predA), xlim=c(0,5000000))
plot(density(y_predB), col = "blue", xlim=c(0,5000000), add = T)
plot(density(y_predA), xlim=c(0,5000000))
plot(density(y_predB), col = col=rgb(0, 1, 0, 0.5), xlim=c(0,5000000), add = T)
plot(density(y_predA), xlim=c(0,5000000))
plot(density(y_predB), col =rgb(0, 1, 0, 0.5), xlim=c(0,5000000), add = T)
plot(density(y_predB), col =rgb(0, 1, 0, 0.5), xlim=c(0,5000000), add = T)
plot(density(y_predA), xlim=c(0,5000000))
plot(density(y_predB), col =rgb(0, 1, 0, 0.5), xlim=c(0,5000000), add = T)
plot(density(y_predA), xlim=c(0,5000000))
plot(density(y_predB), col =rgb(0, 1, 0, 0.5), xlim=c(0,5000000), add = T)
plot(density(y_predA), xlim=c(0,5000000))
plot(density(y_predA), xlim=c(0,5000000))
lines(density(y_predB), col =rgb(0, 1, 0, 0.5), xlim=c(0,5000000), add = T)
lines(density(y_predB), col =rgb(0, 1, 0, 0.5), xlim=c(0,5000000))
plot(density(y_predA), xlim=c(0,5000000))
plot(density(y_predA), xlim=c(0,5000000))
lines(density(y_predB), col =rgb(0, 1, 0, 0.5), xlim=c(0,5000000))
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[4]"]*X_predA[9]
#Posterior predictive simulation
(n_sim = nrow(mod_csim))
X_predA = c(750,120,1,2,1,2,0,0,1)
X_predB = c(750,120,1,2,1,2,0,0,1)
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[4]"]*X_predA[9]
y_predA = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
y_meanB = mod_csim[,1] + mod_csim[,2:9]%*%X_predB[1:8] + mod_csim[,"bnew[44]"]*X_predB[9]
y_predB = rlnorm(n=n_sim, meanlog=y_meanB, sdlog = mod_csim[,"sigy"])
plot(density(y_predA), xlim=c(0,5000000))
lines(density(y_predB), col =rgb(0, 1, 0, 0.5), xlim=c(0,5000000))
#Posterior predictive simulation
(n_sim = nrow(mod_csim))
X_predA = c(750,120,1,2,1,2,0,0,1)
X_predB = c(750,120,1,2,1,2,0,0,1)
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[4]"]*X_predA[9]
y_predA = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
y_meanB = mod_csim[,1] + mod_csim[,2:9]%*%X_predB[1:8] + mod_csim[,"bnew[45]"]*X_predB[9]
y_predB = rlnorm(n=n_sim, meanlog=y_meanB, sdlog = mod_csim[,"sigy"])
plot(density(y_predA), xlim=c(0,5000000))
lines(density(y_predB), col =rgb(0, 1, 0, 0.5), xlim=c(0,5000000))
#Posterior predictive simulation
(n_sim = nrow(mod_csim))
X_predA = c(750,120,1,2,1,2,0,0,1)
X_predB = c(750,120,1,2,1,2,0,0,1)
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[11]"]*X_predA[9]
y_predA = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
y_meanB = mod_csim[,1] + mod_csim[,2:9]%*%X_predB[1:8] + mod_csim[,"bnew[45]"]*X_predB[9]
y_predB = rlnorm(n=n_sim, meanlog=y_meanB, sdlog = mod_csim[,"sigy"])
plot(density(y_predA), xlim=c(0,5000000))
lines(density(y_predB), col =rgb(0, 1, 0, 0.5), xlim=c(0,5000000))
X_predA = c(750,120,1,2,1,2,0,0,1)
X_predB = c(750,120,1,2,1,2,0,0,1)
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[1]"]*X_predA[9]
y_predA = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
y_meanB = mod_csim[,1] + mod_csim[,2:9]%*%X_predB[1:8] + mod_csim[,"bnew[45]"]*X_predB[9]
y_predB = rlnorm(n=n_sim, meanlog=y_meanB, sdlog = mod_csim[,"sigy"])
plot(density(y_predA), xlim=c(0,5000000))
lines(density(y_predB), col =rgb(0, 1, 0, 0.5), xlim=c(0,5000000))
#get the  two districts with the highest NEW slopes
pm_params[11:82]
#Posterior predictive simulation
(n_sim = nrow(mod_csim))
X_predA = c(750,120,1,2,1,2,0,0,1)
X_predB = c(750,120,1,2,1,2,0,0,1)
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[58]"]*X_predA[9]
y_predA = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
y_meanB = mod_csim[,1] + mod_csim[,2:9]%*%X_predB[1:8] + mod_csim[,"bnew[45]"]*X_predB[9]
y_predB = rlnorm(n=n_sim, meanlog=y_meanB, sdlog = mod_csim[,"sigy"])
plot(density(y_predA), xlim=c(0,5000000))
lines(density(y_predB), col =rgb(0, 1, 0, 0.5), xlim=c(0,5000000))
X_predA = c(750,120,2,2,1,2,0,0,1)
X_predB = c(750,120,2,2,1,2,0,0,1)
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[58]"]*X_predA[9]
y_predA = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
y_meanB = mod_csim[,1] + mod_csim[,2:9]%*%X_predB[1:8] + mod_csim[,"bnew[45]"]*X_predB[9]
y_predB = rlnorm(n=n_sim, meanlog=y_meanB, sdlog = mod_csim[,"sigy"])
plot(density(y_predA), xlim=c(0,5000000))
lines(density(y_predB), col =rgb(0, 1, 0, 0.5), xlim=c(0,5000000))
X_predA = c(750,120,2,2,1,2,0,1,1)
X_predB = c(750,120,2,2,1,2,0,1,1)
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[58]"]*X_predA[9]
y_predA = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
y_meanB = mod_csim[,1] + mod_csim[,2:9]%*%X_predB[1:8] + mod_csim[,"bnew[45]"]*X_predB[9]
y_predB = rlnorm(n=n_sim, meanlog=y_meanB, sdlog = mod_csim[,"sigy"])
plot(density(y_predA), xlim=c(0,5000000))
lines(density(y_predB), col =rgb(0, 1, 0, 0.5), xlim=c(0,5000000))
X_predA = c(750,120,2,2,1,2,0,1,1)
X_predB = c(750,120,2,2,1,2,0,1,1)
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[58]"]*X_predA[9]
y_predA = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
y_meanB = mod_csim[,1] + mod_csim[,2:9]%*%X_predB[1:8] + mod_csim[,"bnew[45]"]*X_predB[9]
y_predB = rlnorm(n=n_sim, meanlog=y_meanB, sdlog = mod_csim[,"sigy"])
plot(density(y_predA), xlim=c(0,5000000))
lines(density(y_predB), col =rgb(0, 1, 0, 0.5), xlim=c(0,5000000))
X_predA = c(750,150,2,2,1,2,0,1,1)
X_predB = c(750,150,2,2,1,2,0,1,1)
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[58]"]*X_predA[9]
y_predA = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
y_meanB = mod_csim[,1] + mod_csim[,2:9]%*%X_predB[1:8] + mod_csim[,"bnew[45]"]*X_predB[9]
y_predB = rlnorm(n=n_sim, meanlog=y_meanB, sdlog = mod_csim[,"sigy"])
plot(density(y_predA), xlim=c(0,5000000))
lines(density(y_predB), col =rgb(0, 1, 0, 0.5), xlim=c(0,5000000))
X_predA = c(750,150,2,2,1,3,0,1,1)
X_predB = c(750,150,2,2,1,3,0,1,1)
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[58]"]*X_predA[9]
y_predA = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
y_meanB = mod_csim[,1] + mod_csim[,2:9]%*%X_predB[1:8] + mod_csim[,"bnew[45]"]*X_predB[9]
y_predB = rlnorm(n=n_sim, meanlog=y_meanB, sdlog = mod_csim[,"sigy"])
plot(density(y_predA), xlim=c(0,5000000))
lines(density(y_predB), col =rgb(0, 1, 0, 0.5), xlim=c(0,5000000))
plot(density(y_predA), xlim=c(0,5000000))
lines(density(y_predB), col = "red", xlim=c(0,5000000))
X_predA = c(800,150,2,2,1,3,0,1,1)
X_predB = c(800,150,2,2,1,3,0,1,1)
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[58]"]*X_predA[9]
y_predA = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
y_meanB = mod_csim[,1] + mod_csim[,2:9]%*%X_predB[1:8] + mod_csim[,"bnew[45]"]*X_predB[9]
y_predB = rlnorm(n=n_sim, meanlog=y_meanB, sdlog = mod_csim[,"sigy"])
plot(density(y_predA), xlim=c(0,5000000))
lines(density(y_predB), col = "red", xlim=c(0,5000000))
X_predA = c(800,100,2,2,1,3,0,1,1)
X_predB = c(800,100,2,2,1,3,0,1,1)
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[58]"]*X_predA[9]
y_predA = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
y_meanB = mod_csim[,1] + mod_csim[,2:9]%*%X_predB[1:8] + mod_csim[,"bnew[45]"]*X_predB[9]
y_predB = rlnorm(n=n_sim, meanlog=y_meanB, sdlog = mod_csim[,"sigy"])
plot(density(y_predA), xlim=c(0,5000000))
lines(density(y_predB), col = "red", xlim=c(0,5000000))
X_predA = c(700,160,2,2,1,3,0,1,1)
X_predB = c(700,160,2,2,1,3,0,1,1)
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[58]"]*X_predA[9]
y_predA = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
y_meanB = mod_csim[,1] + mod_csim[,2:9]%*%X_predB[1:8] + mod_csim[,"bnew[45]"]*X_predB[9]
y_predB = rlnorm(n=n_sim, meanlog=y_meanB, sdlog = mod_csim[,"sigy"])
plot(density(y_predA), xlim=c(0,5000000))
lines(density(y_predB), col = "red", xlim=c(0,5000000))
X_predA = c(750,160,2,2,1,3,0,0,1)
X_predB = c(750,160,2,2,1,3,0,0,1)
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[58]"]*X_predA[9]
y_predA = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
y_meanB = mod_csim[,1] + mod_csim[,2:9]%*%X_predB[1:8] + mod_csim[,"bnew[45]"]*X_predB[9]
y_predB = rlnorm(n=n_sim, meanlog=y_meanB, sdlog = mod_csim[,"sigy"])
plot(density(y_predA), xlim=c(0,5000000))
lines(density(y_predB), col = "red", xlim=c(0,5000000))
X_predA = c(750,160,2,2,1,2,0,0,1)
X_predB = c(750,160,2,2,1,2,0,0,1)
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[58]"]*X_predA[9]
y_predA = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
y_meanB = mod_csim[,1] + mod_csim[,2:9]%*%X_predB[1:8] + mod_csim[,"bnew[45]"]*X_predB[9]
y_predB = rlnorm(n=n_sim, meanlog=y_meanB, sdlog = mod_csim[,"sigy"])
plot(density(y_predA), xlim=c(0,5000000))
lines(density(y_predB), col = "red", xlim=c(0,5000000))
X_predA = c(750,160,2,2,1,2,0,0,1)
X_predB = c(750,160,2,2,1,2,0,0,1)
X_predC = c(750,160,2,2,1,2,0,0,1)
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[58]"]*X_predA[9]
y_predA = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
y_meanB = mod_csim[,1] + mod_csim[,2:9]%*%X_predB[1:8] + mod_csim[,"bnew[45]"]*X_predB[9]
y_predB = rlnorm(n=n_sim, meanlog=y_meanB, sdlog = mod_csim[,"sigy"])
y_meanC = mod_csim[,1] + mod_csim[,2:9]%*%X_predC[1:8] + mod_csim[,"bnew[45]"]*X_predC[9]
y_predC = rlnorm(n=n_sim, meanlog=y_meanC, sdlog = mod_csim[,"sigy"])
plot(density(y_predA), xlim=c(0,5000000))
lines(density(y_predB), col = "red", xlim=c(0,5000000))
X_predA = c(750,160,2,2,1,2,0,0,1)
X_predB = c(750,160,2,2,1,2,0,0,1)
X_predC = c(750,160,2,2,1,2,0,0,1)
y_meanA = mod_csim[,1] + mod_csim[,2:9]%*%X_predA[1:8] + mod_csim[,"bnew[58]"]*X_predA[9]
y_predA = rlnorm(n=n_sim, meanlog=y_meanA, sdlog = mod_csim[,"sigy"])
y_meanB = mod_csim[,1] + mod_csim[,2:9]%*%X_predB[1:8] + mod_csim[,"bnew[45]"]*X_predB[9]
y_predB = rlnorm(n=n_sim, meanlog=y_meanB, sdlog = mod_csim[,"sigy"])
y_meanC = mod_csim[,1] + mod_csim[,2:9]%*%X_predC[1:8] + mod_csim[,"bnew[11]"]*X_predC[9]
y_predC = rlnorm(n=n_sim, meanlog=y_meanC, sdlog = mod_csim[,"sigy"])
plot(density(y_predA), xlim=c(0,5000000))
lines(density(y_predB), col = "red", xlim=c(0,5000000))
lines(density(y_predC), col = "blue", xlim=c(0,5000000))
lines(density(y_predC), col = "blue", xlim=c(0,5000000))
legend('topleft',c('District 58','District 45', 'District 11'),
fill = rgb(1:0,0,0:1,0.4), bty = 'n',
border = NA)
lines(density(y_predB), col = "red", xlim=c(0,5000000))
lines(density(y_predC), col = "blue", xlim=c(0,5000000))
legend('topleft',c('District 58','District 45', 'District 11'), bty = 'n',
border = NA)
plot(density(y_predA), xlim=c(0,5000000))
lines(density(y_predB), col = "red", xlim=c(0,5000000))
lines(density(y_predC), col = "blue", xlim=c(0,5000000))
legend('topleft',c('District 58','District 45', 'District 11'), bty = 'n',
border = NA)
legend('topright',c('District 58','District 45', 'District 11'), bty = 'n',
border = NA)
lines(density(y_predB), col = "red", xlim=c(0,5000000))
plot(density(y_predA), xlim=c(0,5000000))
lines(density(y_predB), col = "red", xlim=c(0,5000000))
lines(density(y_predC), col = "blue", xlim=c(0,5000000))
legend('topright',c('District 58','District 45', 'District 11'), fill = c("black","red","blue"), bty = 'n',
border = NA)
#get the  two districts with the highest NEW slopes
pm_params[11:82]
mean(y_predA > 2000000)
mean(y_predB > 2000000)
mean(y_predB > 2000000)
mean(y_predA > 1500000)
mean(y_predB > 1500000)
mean(y_predB > 1500000)
mean(y_predA > 1500000)
mean(y_predB > 1500000)
mean(y_predC > 1500000)
